(jbuild_version 1)

(library
 ((name        lbfgs)
  (public_name lbfgs)
  (flags      (:standard -w -9 -safe-string))
  (c_names    (lbfgs_stubs )); Lbfgsb.3.0/timer
  (c_flags    ((:include c_flags.sexp)))
  (c_library_flags (:include c_library_flags.sexp))
  (libraries  (bigarray bytes))
  (synopsis "Bound-constrainted optimization in many variables")))

(rule
 ((targets (lbfgs.ml))
  (deps    (lbfgs.p4.ml lbfgs_FC.p4.ml))
  (action  (run ocamlrun camlp4o ${read-lines:camlp4.txt}
             -parser Camlp4MacroParser
             -printer Camlp4OCamlPrinter ${<} -o ${@}))))

(rule
 ((targets (c_flags.sexp c_library_flags.sexp camlp4.txt))
  (deps (../config/discover.exe))
  (action (run ${<}))))
